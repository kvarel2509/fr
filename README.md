# Сервис уведомлений
## Установка
- Клонируйте репозиторий
```sh
git clone https://gitlab.com/kvarel2509/fr.git
```
- Создайте файл .env в корне проекта, заполните его на основе шаблона .env.example
##### Разработка
- Установите завиимости с помощью poetry
```sh
poetry install
```

- Выполните миграции БД
```sh
poetry run ./manage.py migrate
```
- запустите тестовый сервер командой
```sh
poetry run ./manage.py runserver
```
Для выполнения фоновых задач вас должен быть установлен Redis
- Запустите redis сервер командой
```sh
redis-server
```
- Запустите обработчиков задач
```sh
celery -A main worker -l info
celery -A main beat -l info
```
#### Docker
Запустите контейнер Docker командой
```sh
docker compose up
```

## Использование
В проекте реализованы следующие формы взаимодействия:
- WEB UI формат
Доступ предоставляется через основную страницу "localhost:8000/"
- API
Доступ предоставляется через основную страницу API "localhost:8000/api/v1"
С документацией по методам API можно ознакомиться в файле openapi-schema.yml в корне проекта либо по адресу "localhost:8000/api/v1/docs/"
- Интерфейс администратора
Доступ предоставляется через основную административную страницу  "localhost:8000/admin/"

## Дополнительно
В сервисе релизованы основные требования к сервису, а также дополнительные пункты:
- 1 организовать тестирование написанного кода(частично)
- 3 подготовить docker-compose для запуска всех сервисов проекта одной командой
- 5 сделать так, чтобы по адресу /docs/ открывалась страница со Swagger UI и в нём отображалось описание разработанного API. Пример: https://petstore.swagger.io
- 6 реализовать администраторский Web UI для управления рассылками и получения статистики по отправленным сообщениям
- 7 обеспечить интеграцию с внешним OAuth2 сервисом авторизации для административного интерфейса. Пример: https://auth0.com
- 8 реализовать дополнительный сервис, который раз в сутки отправляет статистику по обработанным рассылкам на email
- 9 удаленный сервис может быть недоступен, долго отвечать на запросы или выдавать некорректные ответы. Необходимо организовать обработку ошибок и откладывание запросов при неуспехе для последующей повторной отправки. Задержки в работе внешнего сервиса никак не должны оказывать влияние на работу сервиса рассылок.
- 11 реализовать дополнительную бизнес-логику: добавить в сущность "рассылка" поле "временной интервал", в котором можно задать промежуток времени, в котором клиентам можно отправлять сообщения с учётом их локального времени. Не отправлять клиенту сообщение, если его локальное время не входит в указанный интервал.
